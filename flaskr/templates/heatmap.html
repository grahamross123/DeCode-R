{% extends 'base.html' %} {% block content %}
<script type="module">
  import { Heatmap } from "{{ url_for('static', filename='js/heatmap.js') }}";
  import { initUi } from "{{ url_for('static', filename='js/ui.js') }}";
  var labelsDict = JSON.parse(`{{ labels | tojson | safe }}`);
  var predictions = JSON.parse(`{{ predictions | tojson | safe }}`);
  var imageData = JSON.parse(`{{ slide_image | tojson | safe }}`);
  var name = "{{ name }}";
  let heatmap = new Heatmap(predictions, labelsDict, name, imageData);
  initUi();
</script>
{% include 'sidebar.html' %}
<div class="wrapper float-l">
  <div id="viewer" class="col">
    <button class="overlay-option-top" id="magnification-button">x 10</button>
    <div id="viewer-img-box" class="image-box">
      <img id="viewer-img" />
      <div id="viewer-tile-highlight"></div>
    </div>
  </div>
  <div class="col" id="heatmap">
    <div
      class="overlay-option-top dropdown float-l margin-l"
      data-control="checkbox-dropdown"
    >
      <label class="dropdown-label" id="heatmap-label">Select Heatmap</label>
      <div class="dropdown-list" id="heatmap-radio-list">
        <label class="dropdown-option">
          <input
            type="radio"
            name="dropdown-group"
            value="None"
            checked="checked"
          />
          None
        </label>
        {% for mutation in predictions.keys() %}
        <label class="dropdown-option">
          <input type="radio" name="dropdown-group" value="{{ mutation }}" />
          {{ mutation }}
        </label>
        {% endfor %}
      </div>
    </div>
    <div
      class="overlay-option-top dropdown"
      data-control="checkbox-dropdown"
      style="left: 180px"
    >
      <label class="dropdown-label" id="labels-label">Select Labels</label>
      <div class="dropdown-list" id="labels-checkbox-list">
        <label class="dropdown-option">
          <input type="checkbox" name="dropdown-group" id="select-all" />
          Select all
        </label>
        <hr />
        {% for label in all_labels %}
        <label class="dropdown-option">
          <input type="checkbox" name="dropdown-group" value="{{ label }}" />
          {{ label }}
        </label>
        {% endfor %}
      </div>
    </div>
    <button
      class="overlay-option-top"
      style="float: right; right: 5px"
      id="reset-image-button"
    >
      Reset
    </button>
    <div
      id="magnification-display"
      class="overlay-option-bottom"
      style="float: left; bottom: 5px; left: 5px"
    >
      Magnification: 1x
    </div>
    <div class="image-box float-l">
      <div class="image-interactive" id="image-interactive">
        <img class="heatmap-img" alt="Scan" />
        <div class="predictions"></div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
